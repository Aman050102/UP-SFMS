{% load static %}
<!doctype html>
<html lang="th">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>บันทึกการยืม-คืน • UP-FMS</title>
    <link rel="icon" href="{% static 'img/Logo_of_University_of_Phayao.svg.png' %}" type="image/png" />

    <!-- Base -->
    <link rel="stylesheet" href="{% static 'assets/css/global.css' %}" />
    <link rel="stylesheet" href="{% static 'assets/css/admin_header.css' %}" />
    
    <!-- ใหม่: แยก CSS ของหน้า ledger ออกจากหน้า “จัดการข้อมูล” -->
    <link rel="stylesheet" href="{% static 'assets/css/staff_ledger.css' %}" />

    <script defer src="{% static 'js/staff_borrow.js' %}"></script>
  </head>

  <body data-page="staff-ledger">
    <header class="topbar">
      <div class="brand">
        <img src="{% static 'img/logoDSASMART.png' %}" alt="DSA" class="brand-logo" />
      </div>

      <nav class="mainmenu" aria-label="เมนูหลัก">
        <ul>
          <li><a class="toplink" href="{% url 'staff_console' %}">หน้าหลัก</a></li>

          <li class="has-sub">
            <a href="#" class="toplink">
              จัดการข้อมูล
              <svg class="caret" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2"/></svg>
            </a>
            <ul class="submenu" role="menu">
              <li><a role="menuitem" href="{% url 'staff_equipment' %}">ยืม-คืนอุปกรณ์กีฬา</a></li>
              <li><a role="menuitem" href="{% url 'staff_badminton_booking' %}">จองสนามแบดมินตัน</a></li>
            </ul>
          </li>

          <li class="has-sub">
            <a href="#" class="toplink">
              รายงาน
              <svg class="caret" viewBox="0 0 24 24" aria-hidden="true"><path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2"/></svg>
            </a>
            <ul class="submenu" role="menu">
              <li><a role="menuitem" href="{% url 'checkin_report' %}">ข้อมูลการเข้าใช้สนาม</a></li>
              <li><a role="menuitem" href="{% url 'staff_borrow_stats' %}">ข้อมูลสถิติการยืม-คืน</a></li>
            </ul>
          </li>
        </ul>
      </nav>

      <div class="righttools">
        <span class="user-btn" aria-label="ผู้ใช้ปัจจุบัน">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <path d="M20 21a8 8 0 0 0-16 0" />
            <circle cx="12" cy="7" r="4" />
          </svg>
          {{ display_name }}
        </span>

        <form action="{% url 'logout' %}" method="post" class="logout-form">
          {% csrf_token %}
          <button type="submit" class="logout" title="ออกจากระบบ" aria-label="ออกจากระบบ">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
              <path d="M16 17l5-5-5-5" />
              <path d="M21 12H9" />
            </svg>
            ออกจากระบบ
          </button>
        </form>
      </div>
    </header>

    <main class="wrap" data-api-records-url="{% url 'api_staff_borrow_records' %}">
      <!-- แถบสลับ -->
      <nav class="mainmenu" aria-label="เมนูหลัก">
        <ul>
          <li><a class="tab" href="{% url 'staff_equipment' %}">จัดการอุปกรณ์กีฬา</a></li>
          <li><a class="tab active" href="{% url 'staff_borrow_ledger' %}">✓ บันทึกการยืม-คืน</a></li>
        </ul>
      </nav>

      <h1 class="page-title">บันทึกการยืม–คืน (รายวัน)</h1>

      <div class="filter-row">
        <label class="fld">
          <span>รหัสนิสิต</span>
          <input id="studentId" type="text" placeholder="เช่น b6500001" />
        </label>
        <label class="fld">
          <span>วันที่</span>
          <input id="datePick" type="date" />
        </label>
        <button id="btnSearch" class="btn primary">ค้นหา</button>
        <button id="btnToday" class="btn">วันนี้</button>
        <span class="flex1"></span>
      </div>

      <!-- ผลลัพธ์ -->
      <section class="panel">
        <div id="resultInfo" class="result-info">—</div>

        <!-- กลุ่มรายวัน (เรนเดอร์ด้วย JS) -->
        <div id="dayGroups" class="day-groups" aria-live="polite"></div>
      </section>
    </main>
  </body>
</html>